# === Proxmox-hardened SSHD Config ===
# Port 22: Proxmox cluster only (firewall-restricted)
# Port 2211: Admin key-only access

Port 22
Port 2211
ListenAddress 0.0.0.0

# Host Keys (ED25519 + RSA)
HostKey /etc/ssh/ssh_host_ed25519_key
HostKey /etc/ssh/ssh_host_rsa_key

# PCI-DSS 4.0 Crypto
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
Ciphers aes256-gcm@openssh.com,chacha20-poly1305@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256

# Security & Access
PermitRootLogin prohibit-password
PasswordAuthentication no
AuthenticationMethods publickey
MaxAuthTries 3
PermitEmptyPasswords no
KbdInteractiveAuthentication no
LoginGraceTime 30
ClientAliveInterval 300
ClientAliveCountMax 3
UsePAM yes                     # Required for other apps
X11Forwarding no
AllowAgentForwarding no
AllowTcpForwarding no
PermitTunnel no

AuthorizedKeysFile .ssh/authorized_keys
AcceptEnv none

Subsystem sftp /usr/lib/openssh/sftp-server
